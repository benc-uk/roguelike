<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sprite Editor</title>
    <script type="module" src="main.js"></script>
    <link rel="shortcut icon" href="favicon.png" type="image/png" />
  </head>
  <body x-data="app">
    <div class="row" aria-label="Toolbar">
      <button>NEW</button>
      <button>LOAD</button>
      <button>SAVE</button>
      <button>EXPORT</button>
      <button>CONFIG</button>
    </div>

    <div class="row" aria-label="Main area">
      <div x-data="editor(size)" class="padded" x-effect="drawSprite(); drawGrid()">
        <canvas width="600" height="600" x-ref="canvas" @click="handleClick" @contextmenu.prevent="handleClick" @mousemove="handleClick">
        </canvas>
        <br />
        <span x-text="sprite.name"></span>
      </div>

      <div>
        <div x-data="palette" class="padded pallete">
          <template x-for="(colour, index) in $store.pal.colours" :key="index">
            <input type="color" 
            :value="colour" 
            @change="editColour($event, index)" 
            @click="$store.pal.select(index)"
            @contextmenu="selectColour($event, index)"
            :class="index == $store.pal.selected() ? 'selected' : ''"/>
          </template>
        </div>

        <div x-data="bank" class="padded bank" x-effect="updateSprite">
          <template x-for="(imgSrc, index) in spriteImages">
            <img :src="imgSrc" @click="$store.sprites.select(index)" 
            :class="index == $store.sprites.selectedIndex() ? 'selected' : ''"></img>
          </template>
        </div>
      </div>
    </div>

    <div class="row" aria-label="Scratch area">
      <div x-data="scratch()" class="padded scratch" x-ref="scratchGrid" x-effect="updateSprite">
        <template x-for="(cell, index) in map">
          <img :src="cell.image" @click="clickCell($event, index)" @contextmenu.prevent="clickCell($event, index)"/>
        </template>
      </div>
    </div>


    <script type="module">
      // Import and initialize Alpine.js
      import Alpine from 'https://cdn.jsdelivr.net/npm/alpinejs@3.14.0/dist/module.esm.min.js'
      Alpine.start()
    </script>
  </body>
</html>
